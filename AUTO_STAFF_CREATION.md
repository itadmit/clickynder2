# יצירת עובד אוטומטית בהרשמה

## 📋 סקירה כללית

כאשר משתמש נרשם ויוצר עסק חדש, המערכת יוצרת אוטומטית עובד ראשון - **הבעלים עצמו**.

## 🎯 מטרה

- **לחסוך זמן**: הבעלים לא צריך ליצור את עצמו כעובד
- **לאפשר תורים מיד**: עם עובד אחד כבר אפשר לקבל תורים
- **UX טוב יותר**: פחות שלבים עד שהמערכת מוכנה

## 🔧 איך זה עובד?

### בזמן הרשמה (`/api/auth/register`)

כאשר משתמש נרשם, המערכת יוצרת באופן אוטומטי:

1. **משתמש** (User)
2. **עסק** (Business)
3. **חבילת Starter** (Subscription)
4. **מדיניות זמנים** (SlotPolicy)
5. **שעות עבודה** (BusinessHours)
6. **✨ עובד ראשון** (Staff) - **חדש!**

### פרטי העובד הראשון

העובד נוצר עם הפרטים הבאים:

```typescript
{
  name: שם המשתמש שנרשם,
  email: האימייל של המשתמש,
  phone: הטלפון של המשתמש (אם סיפק),
  roleLabel: 'בעלים',
  active: true,
  calendarColor: '#0ea5e9' // כחול
}
```

## 📄 קוד

### קובץ: `src/app/api/auth/register/route.ts`

```typescript
// יצירת עובד ראשון - בעל העסק עצמו
await prisma.staff.create({
  data: {
    businessId: user.ownedBusinesses[0].id,
    name: validatedData.name,
    email: validatedData.email,
    phone: validatedData.phone || null,
    roleLabel: 'בעלים',
    active: true,
    calendarColor: '#0ea5e9', // כחול ברירת מחדל
  },
});
```

## ✅ יתרונות

1. **פחות צעדי Setup**: משתמש חדש כבר יכול לקבוע תורים
2. **UX טוב יותר**: אין הודעת "אין עובדים" ביצירת תור
3. **הגיוני**: הבעלים הוא בדרך כלל גם ספק שירות
4. **אוטומציה**: פחות פעולות ידניות למשתמש

## 🔄 מה קורה בדף הבוקינג?

### לפני השינוי:
```
❌ אין שירותים → הודעת שגיאה
❌ אין עובדים → הודעת שגיאה
❌ אין סניפים → הודעת שגיאה
```

### אחרי השינוי:
```
✅ יש עובד אחד (הבעלים)
❌ אין שירותים → הודעה: "צריך להוסיף שירותים"
❌ אין סניפים → הודעה: "צריך להוסיף סניף"
```

## 📝 הערות

- העובד נוצר רק אם יצירת החבילה הצליחה
- ניתן למחוק/לערוך את העובד בדשבורד
- ניתן להוסיף עובדים נוספים בכל זמן
- העובד מקושר לעסק ולא לסניף ספציפי (branchId = null)

## 🚀 דוגמה לתהליך הרשמה מלא

1. משתמש ממלא טופס הרשמה
2. המערכת יוצרת:
   - ✅ User: `יונב אביטן`
   - ✅ Business: `תדמית אינטראקטיב`
   - ✅ Subscription: חבילת Starter (30 יום ניסיון)
   - ✅ SlotPolicy: זמני ברירת מחדל
   - ✅ BusinessHours: א'-ה' 8:00-17:00
   - ✅ **Staff: יונב אביטן (בעלים)**
3. משתמש מועבר לדשבורד
4. עכשיו צריך רק:
   - להוסיף שירות אחד
   - להוסיף סניף אחד
   - ✅ כבר יש עובד!

## 🎨 UX Flow

```
הרשמה → דשבורד → הודעה: "עוד צעד אחד ותהיה מוכן"

חסר:
  ❌ שירות ראשון → הוסף שירות
  ❌ סניף ראשון → הוסף סניף
  ✅ עובד ראשון → כבר קיים!
```

## 🔄 עדכונים עתידיים

אפשר לשקול:
- יצירת **סניף ברירת מחדל** גם כן
- יצירת **קטגוריית שירות ראשונה**
- שאילת שאלות בהרשמה (סוג עסק) ויצירת תבנית מתאימה

